\setchapterpreamble[u]{\margintoc}
\chapter{A Brief Introduction}
\labch{intro}


\section{Why Urbit Matters}
\labsec{matters}

Urbit is a  network-first,
compatibility-breaking

As of this writing, Urbit runs on any of several interpreters as a "hosted OS," or a

% Write like SeeTee shareholder letter but for Urbit, demolish all objections

Let us posit a social operating system, or SOS;  a protocol for network-oriented platforms to utilize to ensure that user requirements are met securely.  If we enumerate user-oriented desiderata for a social operating system, surely the following must rank prominently:

\begin{itemize}
	\item  Privacy
	\item  Security
	\item  Ownership
\end{itemize}


\section{Azimuth, the Urbit Address Space}
\labsec{azimuth}


Zooko's trilemma


Many modern printed textbooks have adopted a layout with prominent
margins where small figures, tables, remarks and just about everything
else can be displayed. Arguably, this layout helps to organise the
	discussion by separating the main text from the ancillary material,
	which at the same time is very close to the point in the text where
	it is referenced.

This document does not aim to be an apology of wide margins, for there
are many better suited authors for this task; the purpose of all these
words is just to fill the space so that the reader can see how a book
written with the kaobook class looks like. Meanwhile, I shall also try
to illustrate the features of the class.

The main ideas behind kaobook come from this
\href{https://3d.bk.tudelft.nl/ken/en/2016/04/17/a-1.5-column-layout-in-latex.html}{blog
	post}, and actually the name of the class is dedicated to the author
of the post, Ken Arroyo Ohori, which has kindly allowed me to create a
class based on his thesis. Therefore, if you want to know more reasons
to prefer a 1.5-column layout for your books, be sure to read his blog
post.

Another source of inspiration, as you may have noticed, is the
\href{https://github.com/Tufte-LaTeX/tufte-latex}{Tufte-Latex Class}.
The fact that the design is similar is due to the fact that it is very
difficult to improve something wich is already so good. However, I like
to think that this class is more flexible than Tufte-Latex. For
instance, I have tried to use only standard packages and to implement as
little as possible from scratch;\sidenote{This also means that
understanding and contributing to the class development is made easier.
Indeed, many things still need to be improved, so if you are interested,
check out the repository on github!} therefore, it should be pretty easy
to customise anything, provided that you read the documentation of the
package that provides that feature.

\marginnote[2mm]{In addition to the pronounceable \patp s, the sigil system affords a unique visual representation of each addressable point less than $2^{32}$.}

In this book I shall illustrate the main features of the class and
provide information about how to use and change things. Let us get
started.

\section{Accessing Urbit}
\labsec{access}

The \Class{kaobook} class focuses more about the document structure than
about the style. Indeed, it is a well-known \LaTeX\xspace principle that
structure and style should be separated as much as possible (see also
\vrefsec{doesnot}). This means that this class will only provide
commands, environments and in general, the opportunity to do things,
which the user may or may not use. Actually, some stylistic matters are
embedded in the class, but the user is able to customise them with ease.

The main features are the following:

\begin{description}
	\item[Page Layout] The text width is reduced to improve readability
	and make space for the margins, where any sort of elements can be
	displayed.
	\item[Chapter Headings] As opposed to Tufte-Latex, we provide a
	variety of chapter headings among which to choose; examples will be
	seen in later chapters.
	\item[Page Headers] They span the whole page, margins included, and,
	in twoside mode, display alternatively the chapter and the section
	name.\sidenote[][-2mm]{This is another departure from Tufte's
	design.}
	\item[Matters] The commands \Command{frontmatter},
	\Command{mainmatter} and \Command{backmatter} have been redefined in
	order to have automatically wide margins in the main matter, and
	narrow margins in the front and back matters. However, the page
	style can be changed at any moment, even in the middle of the
	document.
	\item[Margin text] We provide commands \Command{sidenote} and
	\Command{marginnote} to put text in the
	margins.\sidenote[][-2mm]{Sidenotes (like this!) are numbered while
	marginnotes are not}
	\item[Margin figs/tabs] A couple of useful environments is
	\Environment{marginfigure} and \Environment{margintable}, which, not
	surprisingly, allow you to put figures and tables in the margins
	(\cfr \reffig{marginmonalisa}).
	\item[Margin toc] Finally, since we have wide margins, why don't add
	a little table of contents in them? See \Command{margintoc} for
	that.
	\item[Hyperref] \Package{hyperref} is loaded and by default we try
	to add bookmarks in a sensible way; in particular, the bookmarks
	levels are automatically reset at \Command{appendix} and
	\Command{backmatter}. Moreover, we also provide a small package to
	ease the hyperreferencing of other parts of the text.
	\item[Bibliography] We want the reader to be able to know what has
	been cited without having to go to the end of the document every
	time, so citations go in the margins as well as at the end, as in
	Tufte-Latex. Unlike that class, however, you are free to customise
	the citations as you wish.
\end{description}

\begin{marginfigure}[-5.5cm]
	\includegraphics{monalisa}
	\caption[Sigils]{Some sigils\\
	\url{https://media.urbit.org/site/posts/essays/help-the-environment.jpg}}
	\labfig{marginsigils}
\end{marginfigure}

\section{Developing for Urbit}
\labsec{developing}

Urbit development can be divided into three cases:

\begin{enumerate}
	\item  Kernel development
	\item  Userspace development, Urbit-side (\gall~and generators)
	\item  Userspace development, client-side (Urbit API)
\end{enumerate}

This guide focuses on getting the reader up to speed on the second development case early, then branches out.

We encourage the reader to approach each example and exercise in the following spirit:

\begin{enumerate}
  \item  Identify the input and outputs, preferably at the data type level and contents.
	\item  Reason analogically from other Hoon examples available in the text and elsewhere.
	\item  Create and complete an outline of the code content.
	\item  Devise and compose a suitable test suite.
\end{enumerate}
